<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Supermercado PRO MAX</title>

<link rel="apple-touch-icon" sizes="1024x1024" href="icon-1024.png">
<link rel="icon" type="image/png" sizes="1024x1024" href="icon-1024.png">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="Supermercado">

<style>
  body{font-family:Arial;margin:0;background:#f4f6f8}
  header{background:#2e7d32;color:#fff;padding:14px;text-align:center;font-size:20px}
  .container{padding:15px}
  select,input,button{width:100%;padding:12px;margin:6px 0;font-size:16px}
  button{border:none;border-radius:6px;cursor:pointer}
  .green{background:#2e7d32;color:#fff}
  .red{background:#c62828;color:#fff}
  .orange{background:#ef6c00;color:#fff}
  table{width:100%;border-collapse:collapse;margin-top:15px}
  th,td{border:1px solid #ccc;padding:8px;text-align:center}
  tr.surtido{background:#c8e6c9;text-decoration:line-through}
  hr{margin:15px 0}
  .oculto{display:none}
  tr.selected{background-color:#ffe082 !important}
</style>
</head>
<body>

<header>ðŸ›’ Supermercado PRO MAX</header>

<div class="container">
  <select id="categoria"></select>
  <input type="text" id="buscador" placeholder="Buscar producto por nombre">
  <select id="producto"></select>
  <input type="number" id="cantidad" value="1" min="1">
  <input type="number" id="precio" placeholder="Precio" min="0" step="0.01">

  <button class="green" onclick="agregar()">Agregar</button>
  <button class="red" onclick="eliminar()">Eliminar seleccionado</button>
  <button class="orange" onclick="limpiar()">Limpiar lista</button>

  <table>
    <thead>
      <tr>
        <th>Cat.</th>
        <th>Producto</th>
        <th>Cant.</th>
        <th>Precio</th>
        <th>Subtotal</th>
        <th>âœ”</th>
      </tr>
    </thead>
    <tbody id="lista"></tbody>
  </table>

  <h3 id="total">Total: $0</h3>
</div>

<script>
const catalogo = {
 "Abarrotes":["Arroz", "Frijol", "Lentejas", "Garbanzos", "Papel Aluminio", "Azucar", "Chiles JalapeÃ±os", "Chile Chipotle", "Chiles en Rajas", "Chicharos", "Tortillas de Arina", "Tortillas de Maiz", "Atole", "Sal", "Aderezos", "Harina de trigo", "Harina de maiz", "Aceite vegetal", "Aceite de oliva", "Vinagre", "Cafe molido", "Cafe soluble", "Te", "Avena", "Cereal de maiz", "Pasta espagueti", "Pasta codito", "Salsa de tomate", "Pure de tomate", "Mayonesa", "Mostaza", "Ketchup", "Chiles enlatados", "Atun en lata", "Sardinas en lata", "Sopa instantanea", "Caldo en cubos", "Galletas saladas", "Galletas dulces", "Pan de caja", "Pan molido", "Mermelada", "Miel", "Chocolate en polvo", "Gelatina", "Levadura", "Especias mixtas", "Consome", "Almidon de maiz"],
 "Carnes":["Carne molida de res", "Bistec de res", "Chuleta de res", "Costilla de res", "Arrachera", "Diezmillo", "Pechuga de pollo", "Pierna de pollo", "Muslo de pollo", "Pollo entero", "Filete de pescado", "Pescado entero", "Carne molida de cerdo", "Chuleta de cerdo", "Lomo de cerdo", "Costilla de cerdo", "Tocino", "Jamon", "Salchichas", "Chorizo", "Longaniza", "Salami", "Mortadela", "Salchichon", "Carne para hamburguesa", "Nuggets de pollo", "Alitas de pollo", "Carne para milanesa", "Carne seca", "Carne marinada", "Filete de tilapia", "Filete de salmon", "Filete de atun", "Mojarra entera", "Bagre entero", "Robalo entero", "Huachinango entero", "Sierra en rodajas", "Camaron crudo", "Camaron cocido", "Pulpo", "Calamar", "Jaiba", "Surimi", "Pescado empanizado"],
 "LÃ¡cteos":["Leche entera", "Leche semidescremada", "Leche descremada", "Leche deslactosada", "Leche evaporada", "Leche condensada", "Leche en polvo", "Huevo", "Yogur natural", "Yogur griego", "Yogur bebible", "Queso fresco", "Queso crema", "Queso mozzarella", "Queso cheddar", "Queso manchego", "Queso parmesano", "Queso gouda", "Queso azul", "Requeson", "Ricotta", "Mantequilla", "Margarina lactea", "Crema de leche", "Crema agria", "Suero de leche", "Helado", "Paletas de crema", "Flan de leche", "Natilla", "Kefir"],
 "Bebidas":["Agua embotellada", "Refrescos", "Jugos", "Cervezas y vinos"],
 "Snacks y Dulces":["Papas fritas", "Galletas", "Chocolates", "Mantecaditos", "Chicles"],
"Cereales":["Almendra", "Anacardo", "Avellana", "Cacahuate", "Castana de caju", "Castana de Brasil", "Chia", "Coco rallado", "Datil seco", "Higo seco", "Lino", "Nuez", "Nuez de macadamia", "Nuez pecana", "Pasas", "Pistache", "Semilla de calabaza", "Semilla de girasol", "Semilla de sesamo", "Semilla de amapola"],
 "Productos de Higiene Personal":["Jabon de baÃ±o", "Champu", "Pasta de dientes", "Desodorante", "Bicarbonato"],
  "Frutas y Verduras":["Acelga", "Aguacate", "Ajo", "Alcachofa", "Apio", "Arandano", "Berenjena", "Betabel", "Brocoli", "Calabacita", "Calabaza", "Camote", "Carambola", "Cebolla", "Cebollin", "Cereza", "ChampiÃ±on", "Chile", "Chicharo", "Chirimoya", "Ciruela", "Coco", "Col", "Col morada", "Coliflor", "Durazno", "Elote", "Endivia", "Escarola", "Esparrago", "Espinaca", "Fresa", "Frambuesa", "Garbanzo tierno", "Granada", "Grosella", "Guayaba", "Haba", "Higo", "Jicama", "Kiwi", "Lechuga", "Lenteja verde", "Limon", "Litchi", "Mandarina", "Mamey", "Manzana", "Manzana verde", "Maracuya", "Melon", "Mango", "Nabo", "Naranja", "Nispero", "Papa", "Papaya", "Pera", "Pera roja", "Pepino", "Pimiento", "PiÃ±a", "Pitahaya", "Platano", "Platano macho", "Platano dominico", "Rabano", "Repollo", "Rucula", "Sandia", "Seta", "Tomate", "Toronja", "Tuna", "Uva", "Uva verde", "Zapote", "Zanahoria", "Zarzamora"],
 "Limpieza":["Detergente en polvo", "Detergente liquido", "Suavizante de telas", "Jabon en barra para lavar", "Jabon liquido para manos", "Cloro", "Blanqueador", "Desinfectante liquido", "Desinfectante en aerosol", "Limpiador multiusos", "Limpiador de pisos", "Limpiador de baÃ±os", "Limpiador de cocina", "Limpiador de vidrios", "Limpiador de hornos", "Limpiador de acero inoxidable", "Quitamanchas", "Desengrasante", "Alcohol", "Amoniaco", "Limpiador aromatizante", "Pastillas para WC", "Gel limpiador para WC", "Escoba", "Trapeador", "Cubeta", "Fibra para tallar", "Esponjas", "Trapos de limpieza", "Toallas desechables", "Servilletas", "Papel higienico", "Papel de cocina", "Bolsas para basura", "Insecticida", "Repelente de insectos", "Aromatizante ambiental", "Limpiador antibacterial", "Guantes de limpieza", "Cepillo para baÃ±o"]
};

let compras = JSON.parse(localStorage.getItem("compras")) || [];
let sel = null;

const categoria = document.getElementById("categoria");
const producto = document.getElementById("producto");
const buscador = document.getElementById("buscador");

function cargarCategorias(){
  categoria.innerHTML = "";
  categoria.add(new Option("Todos","Todos"));
  Object.keys(catalogo).forEach(c => categoria.add(new Option(c,c)));
  cargarProductos();
}

function cargarProductos(f=""){
  producto.innerHTML = "";

  if(categoria.value === "Todos"){
    Object.keys(catalogo).forEach(c=>{
      catalogo[c]
        .filter(p=>p.toLowerCase().includes(f.toLowerCase()))
        .forEach(p=>producto.add(new Option(`${p} (${c})`,p)));
    });
    return;
  }

  catalogo[categoria.value]
    .filter(p=>p.toLowerCase().includes(f.toLowerCase()))
    .forEach(p=>producto.add(new Option(p,p)));
}

categoria.onchange = ()=>{
  buscador.value="";
  cargarProductos();
};

buscador.oninput = ()=>cargarProductos(buscador.value);

function agregar(){
  if(!precio.value) return;

  let catReal = categoria.value;
  if(catReal === "Todos"){
    catReal = Object.keys(catalogo).find(k=>catalogo[k].includes(producto.value));
  }

  compras.push({
    c: catReal,
    p: producto.value,
    ca: +cantidad.value,
    pr: +precio.value,
    s: false
  });

  render();
}

function eliminar(){
  if(sel === null){
    const row = document.querySelector("#lista tr.selected");
    if(row) sel = parseInt(row.dataset.index);
  }

  if(sel !== null && sel >= 0 && sel < compras.length){
    compras.splice(sel,1);
    sel = null;
    render();
  }
}

function limpiar(){
  if(confirm("Â¿Limpiar lista?")){
    compras=[];
    sel=null;
    render();
  }
}

function toggle(i){
  compras[i].s = !compras[i].s;
  render();
}

function render(){
  lista.innerHTML="";
  let totalCompra = 0;

  compras.forEach((x,i)=>{
    const tr = document.createElement("tr");
    tr.dataset.index = i;

    if(x.s) tr.classList.add("surtido");
    if(i === sel) tr.classList.add("selected");

    tr.onclick = ()=>{
      sel = i;
      render();
    };

    tr.innerHTML = `
      <td>${x.c}</td>
      <td>${x.p}</td>
      <td>${x.ca}</td>
      <td>$${x.pr}</td>
      <td>$${x.ca * x.pr}</td>
      <td>
        <input type="checkbox" ${x.s?"checked":""}
        onclick="event.stopPropagation();toggle(${i})">
      </td>
    `;

    lista.appendChild(tr);
    totalCompra += x.ca * x.pr;
  });

  total.innerText = "Total: $" + totalCompra;
  localStorage.setItem("compras", JSON.stringify(compras));
}

cargarCategorias();
render();
</script>

</body>
</html>
