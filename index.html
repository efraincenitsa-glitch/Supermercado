<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Supermercado PRO MAX</title>

<link rel="apple-touch-icon" sizes="1024x1024" href="icon-1024.png">
<link rel="icon" type="image/png" sizes="1024x1024" href="icon-1024.png">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="Supermercado">

<style>
body{font-family:Arial;margin:0;background:#f4f6f8}
header{background:#2e7d32;color:#fff;padding:14px;text-align:center;font-size:20px}
.container{padding:15px}
select,input,button{width:100%;padding:12px;margin:6px 0;font-size:16px}
button{border:none;border-radius:6px}
.green{background:#2e7d32;color:#fff}
.red{background:#c62828;color:#fff}
.orange{background:#ef6c00;color:#fff}
table{width:100%;border-collapse:collapse;margin-top:15px}
th,td{border:1px solid #ccc;padding:8px;text-align:center}
tr.surtido{background:#c8e6c9;text-decoration:line-through}
hr{margin:15px 0}

/* ðŸ”’ OCULTAR ALTA DE PRODUCTO */
.oculto{display:none}
</style>
</head>

<body>
<header>ðŸ›’ Supermercado PRO MAX</header>

<div class="container">

<!-- SELECTORES -->
<select id="categoria"></select>

<!-- ðŸ” BUSCADOR -->
<input type="text" id="buscador" placeholder="Buscar producto por nombre">

<select id="producto"></select>

<input type="number" id="cantidad" value="1" min="1">
<input type="number" id="precio" placeholder="Precio" min="0" step="0.01">

<!-- ALTA PRODUCTO (OCULTO) -->
<div class="oculto">
<hr>
<input type="text" id="nuevoProducto" placeholder="Nuevo producto">
<button class="green" onclick="altaProducto()">âž• Alta producto</button>
<hr>
</div>

<!-- BOTONES -->
<button class="green" onclick="agregar()">Agregar</button>
<button class="red" onclick="eliminar()">Eliminar seleccionado</button>
<button class="orange" onclick="limpiar()">Limpiar lista</button>

<!-- TABLA -->
<table>
<thead>
<tr>
<th>Cat.</th>
<th>Producto</th>
<th>Cant.</th>
<th>Precio</th>
<th>Subtotal</th>
<th>âœ”</th>
</tr>
</thead>
<tbody id="lista"></tbody>
</table>

<h3 id="total">Total: $0</h3>
</div>

<script>
// ===== CATÃLOGO =====
const catalogo = JSON.parse(localStorage.getItem("catalogo")) || {
 "Abarrotes":["Arroz", "Frijol", "Lentejas", "Garbanzos", "AzÃºcar", "Sal", "Harina de trigo", "Harina de maÃ­z", "Aceite vegetal", "Aceite de oliva", "Vinagre", "CafÃ© molido", "CafÃ© soluble", "TÃ©", "Avena", "Cereal de maÃ­z", "Pasta espagueti", "Pasta codito", "Salsa de tomate", "PurÃ© de tomate", "Mayonesa", "Mostaza", "KÃ©tchup", "Chiles enlatados", "AtÃºn en lata", "Sardinas en lata", "Sopa instantÃ¡nea", "Caldo en cubos", "Galletas saladas", "Galletas dulces", "Pan de caja", "Pan molido", "Mermelada", "Miel", "Chocolate en polvo", "Gelatina", "Levadura", "Especias mixtas", "ConsomÃ©", "AlmidÃ³n de maÃ­z"],
 "Carnes":["Carne molida de res", "Bistec de res", "Chuleta de res", "Costilla de res", "Arrachera", "Diezmillo", "Pechuga de pollo", "Pierna de pollo", "Muslo de pollo", "Pollo entero", "Filete de pescado", "Pescado entero", "Carne molida de cerdo", "Chuleta de cerdo", "Lomo de cerdo", "Costilla de cerdo", "Tocino", "JamÃ³n", "Salchichas", "Chorizo", "Longaniza", "Salami", "Mortadela", "SalchichÃ³n", "Carne para hamburguesa", "Nuggets de pollo", "Alitas de pollo", "Carne para milanesa", "Carne seca", "Carne marinada", "Filete de tilapia", "Filete de salmÃ³n", "Filete de atÃºn", "Mojarra entera", "Bagre entero", "Robalo entero", "Huachinango entero", "Sierra en rodajas", "CamarÃ³n crudo", "CamarÃ³n cocido", "Pulpo", "Calamar", "Jaiba", "Surimi", "Pescado empanizado"],
 "LÃ¡cteos":["Leche entera", "Leche semidescremada", "Leche descremada", "Leche deslactosada", "Leche evaporada", "Leche condensada", "Leche en polvo", "Yogur natural", "Yogur griego", "Yogur bebible", "Queso fresco", "Queso crema", "Queso mozzarella", "Queso cheddar", "Queso manchego", "Queso parmesano", "Queso gouda", "Queso azul", "RequesÃ³n", "Ricotta", "Mantequilla", "Margarina lÃ¡ctea", "Crema de leche", "Crema agria", "Suero de leche", "Helado", "Paletas de crema", "Flan de leche", "Natilla", "KÃ©fir"],
 "Limpieza":["Detergente en polvo", "Detergente lÃ­quido", "Suavizante de telas", "JabÃ³n en barra para lavar", "JabÃ³n lÃ­quido para manos", "Cloro", "Blanqueador", "Desinfectante lÃ­quido", "Desinfectante en aerosol", "Limpiador multiusos", "Limpiador de pisos", "Limpiador de baÃ±os", "Limpiador de cocina", "Limpiador de vidrios", "Limpiador de hornos", "Limpiador de acero inoxidable", "Quitamanchas", "Desengrasante", "Alcohol", "AmonÃ­aco", "Limpiador aromatizante", "Pastillas para WC", "Gel limpiador para WC", "Escoba", "Trapeador", "Cubeta", "Fibra para tallar", "Esponjas", "Trapos de limpieza", "Toallas desechables", "Servilletas", "Papel higiÃ©nico", "Papel de cocina", "Bolsas para basura", "Insecticida", "Repelente de insectos", "Aromatizante ambiental", "Limpiador antibacterial", "Guantes de limpieza", "Cepillo para baÃ±o"]
};

// ===== COMPRAS =====
let compras = JSON.parse(localStorage.getItem("compras")) || [];
let sel = null;

const cat = document.getElementById("categoria");
const prod = document.getElementById("producto");
const buscador = document.getElementById("buscador");
const lista = document.getElementById("lista");
const total = document.getElementById("total");

// ===== CARGA =====
function cargarCategorias(){
 cat.innerHTML="";
 Object.keys(catalogo).forEach(c=>cat.add(new Option(c,c)));
 cargarProductos();
}

function cargarProductos(filtro=""){
 prod.innerHTML="";
 catalogo[cat.value]
  .filter(p=>p.toLowerCase().includes(filtro.toLowerCase()))
  .forEach(p=>prod.add(new Option(p,p)));
}

cat.onchange = ()=>{
 buscador.value="";
 cargarProductos();
};

buscador.oninput = ()=>{
 cargarProductos(buscador.value);
};

cargarCategorias();

// ===== FUNCIONES =====
function agregar(){
 if(!precio.value){ alert("Ingresa un precio"); return; }

 compras.push({
  c:cat.value,
  p:prod.value,
  ca:+cantidad.value,
  pr:+precio.value,
  s:false
 });
 render();
}

function eliminar(){
 if(sel!==null){
  compras.splice(sel,1);
  sel=null;
  render();
 }
}

function limpiar(){
 if(confirm("Â¿Limpiar lista?")){
  compras=[];
  render();
 }
}

function toggle(i){
 compras[i].s=!compras[i].s;
 render();
}

function altaProducto(){
 const np=document.getElementById("nuevoProducto").value.trim();
 if(!np)return;
 catalogo[cat.value].push(np);
 localStorage.setItem("catalogo",JSON.stringify(catalogo));
 cargarProductos();
}

function render(){
 lista.innerHTML="";
 let t=0;

 compras.forEach((x,i)=>{
  const tr=document.createElement("tr");
  if(x.s) tr.className="surtido";
  tr.onclick=()=>sel=i;

  tr.innerHTML=`
   <td>${x.c}</td>
   <td>${x.p}</td>
   <td>${x.ca}</td>
   <td>$${x.pr}</td>
   <td>$${x.ca*x.pr}</td>
   <td><input type="checkbox" ${x.s?"checked":""}
    onclick="event.stopPropagation();toggle(${i})"></td>`;
  lista.appendChild(tr);
  t+=x.ca*x.pr;
 });

 total.innerText="Total: $"+t;
 localStorage.setItem("compras",JSON.stringify(compras));
}

render();
</script>
</body>
</html>
